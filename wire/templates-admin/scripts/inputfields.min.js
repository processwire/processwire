var InputfieldDebugMode=false;function consoleLog(note){if(InputfieldDebugMode)console.log(note)}var InputfieldDependenciesProcessing=false;function InputfieldDependencies($target){var $=jQuery;if(InputfieldDependenciesProcessing)return;if(typeof $target=="undefined"){var $target=$(".InputfieldForm:not(.InputfieldFormNoDependencies)")}else if($target.hasClass("InputfieldForm")){if($target.hasClass("InputfieldFormNoDependencies"))return}else{if($target.closest(".InputfieldFormNoDependencies").length>0)return}function trimValue(value){value=jQuery.trim(value);var first=value.substring(0,1);var last=value.substring(value.length-1,value.length);if((first=='"'||first=="'")&&first==last)value=value.substring(1,value.length-1);return value}function trimParseValue(value){return parseValue(trimValue(value))}function extractFieldAndSubfield(field){var subfield="";var dot=field.indexOf(".");if(dot>0){subfield=field.substring(dot+1);field=field.substring(0,dot)}return{field:field,subfield:subfield}}function parseValue(str,str2){str=jQuery.trim(str);if(str.length>0&&!jQuery.isNumeric(str)){return str}if(str.length==0){var t=typeof str2;if(t!="undefined"){if(t=="integer")return 0;if(t=="float")return 0;return str}else{return str}}var dot1=str.indexOf(".");var dot2=str.lastIndexOf(".");if(dot1==-1&&/^-?\d+$/.test(str)){return parseInt(str)}if(dot2>-1&&dot1!=dot2){return str}if(/^-?[\d.]+$/.test(str)){return parseFloat(str)}return str}function matchValue(field,operator,value,conditionValue){var matched=0;switch(operator){case"=":if(value==conditionValue)matched++;break;case"!=":if(value!=conditionValue)matched++;break;case">":if(value>conditionValue)matched++;break;case"<":if(value<conditionValue)matched++;break;case">=":if(value>=conditionValue)matched++;break;case"<=":if(value<=conditionValue)matched++;break;case"*=":case"%=":if(value.indexOf(conditionValue)>-1)matched++;break}consoleLog("Field "+field+" - Current value: "+value);consoleLog("Field "+field+" - Matched? "+(matched>0?"YES":"NO"));return matched}function getCheckboxFieldAndValue(condition,conditionField,conditionSubfield){var $field=null;var value;consoleLog("getCheckboxFieldAndValue(see-next-line, "+conditionField+", "+conditionSubfield+")");consoleLog(condition);if(conditionSubfield=="count"||conditionSubfield=="count-checkbox"){consoleLog("Using count checkbox condition");$field=$("#wrap_Inputfield_"+conditionField+" :input");if($field.length){value=$("#wrap_Inputfield_"+conditionField+" :checked").length;condition.subfield="count-checkbox";return{field:$field,value:value,condition:condition}}return null}consoleLog("Using checkbox value or label comparison option");value=[];for(var i=0;i<condition.values.length;i++){var _conditionValue=new String(condition.values[i]);var conditionValue=trimValue(_conditionValue.replace(/\s/g,"_"));consoleLog("conditionValue: "+conditionValue);var fieldID="#Inputfield_"+conditionField+"_"+conditionValue;$field=$(fieldID);var inputType=$field.attr("type");if($field.length){consoleLog("Found "+inputType+" via value "+fieldID);var val="";if($field.is(":checked")){val=$field.val();consoleLog(inputType+" IS checked: "+fieldID)}else if($field.attr("type")=="radio"){consoleLog(inputType+" is NOT checked: "+fieldID);var $checkedField=$field.closest("form").find('input[name="'+$field.attr("name")+'"]:checked');if($checkedField.length){val=$checkedField.val();consoleLog("Checked value is: "+val)}}else{consoleLog(inputType+" is NOT checked: "+fieldID)}if(val.length){consoleLog("Pushing checked value: "+val);value.push(val)}continue}if(conditionValue.length==0||conditionValue.match(/^[0-9]+$/)){consoleLog("Unable to locate checkbox "+fieldID+", skipping");continue}consoleLog("Attempting to find checkbox by label: "+conditionValue);$field=$("#wrap_Inputfield_"+conditionField);var $checkboxes=$field.find("input:checked");for(var cn=0;cn<$checkboxes.length;cn++){var $checkbox=$checkboxes.eq(cn);var $label=$checkbox.closest("label");if($label.length){var label=jQuery.trim($label.text());if(label==_conditionValue){consoleLog("Matching checked label found: "+_conditionValue);value.push(label)}else{consoleLog("Matching checked label not found: "+_conditionValue)}}}}if($field)return{field:$field,value:value,condition:condition};return null}function inputfieldChange(conditions,$fieldToShow){InputfieldDependenciesProcessing=true;var fieldNameToShow=$fieldToShow.attr("id").replace(/wrap_Inputfield_/,"");if(InputfieldDebugMode){consoleLog("-------------------------------------------------------------------");consoleLog('Field "'+fieldNameToShow+'" detected a change to a dependency field! Beginning dependency checks...')}var numVisibilityChanges=0;var show=true;var requiredMatches=0;var notRequiredMatches=0;for(var c=0;c<conditions.length;c++){var condition=conditions[c];if(InputfieldDebugMode){consoleLog("----");consoleLog("Start Dependency "+c);consoleLog("Condition type: "+condition.type);consoleLog("Field: "+condition.field);if(condition.subfield.length>0)consoleLog("Subfield: "+condition.subfield);consoleLog("Operator: "+condition.operator);consoleLog("Required value: "+condition.value)}var matched=0;for(var fn=0;fn<condition.fields.length;fn++){var fieldAndSubfield=extractFieldAndSubfield(condition.fields[fn]);var conditionField=fieldAndSubfield.field;var conditionSubfield=fieldAndSubfield.subfield;var value=null;var $field=$("#Inputfield_"+conditionField);var hasCheckboxes=false;if($field.length==0)$field=$("#"+conditionField);if($field.length==0){consoleLog("Detected possible checkbox or radio: "+condition.field+condition.operator+condition.value);var fieldAndValue=getCheckboxFieldAndValue(condition,conditionField,conditionSubfield);if(fieldAndValue){$field=fieldAndValue.field;value=fieldAndValue.value;condition=fieldAndValue.condition;hasCheckboxes=true}}if($field.length==0){consoleLog("Unable to locate field: "+conditionField);continue}if(value===null){if($field.attr("type")=="checkbox"){value=$field.is(":checked")?$field.val():null}else{value=$field.val()}}var values=[];if(value==null)value="";if(condition.subfield=="count")value=value.length;if(typeof value=="object"){values=jQuery.makeArray(value)}else if(typeof value=="array"){values=value}else{values[0]=value}var numMatchesRequired=1;if(condition.operator=="!=")numMatchesRequired=values.length*condition.values.length;if(($field.attr("type")=="checkbox"||$field.attr("type")=="radio")&&!$field.is(":checked")){if($("#Inputfield_"+conditionField+"_0").length==0){values[1]="0"}}for(var n=0;n<values.length;n++){for(var i=0;i<condition.values.length;i++){var v=parseValue(values[n],condition.values[i]);matched+=matchValue(conditionField,condition.operator,v,condition.values[i])}}if(matched>=numMatchesRequired)break}consoleLog("----");if(condition.type=="show"){if(matched>=numMatchesRequired){}else{show=false}}else if(condition.type=="required"){if(matched>0){requiredMatches++}else{notRequiredMatches++}}}var required=requiredMatches>0&&notRequiredMatches==0;if(show){consoleLog('Determined that field "'+fieldNameToShow+'" should be visible.');if($fieldToShow.is(".InputfieldStateHidden")){$fieldToShow.removeClass("InputfieldStateHidden").show();$(document).trigger("showInputfield",$fieldToShow);numVisibilityChanges++;consoleLog("Field is now visible.")}else{consoleLog("Field is already visible.")}}else{consoleLog('Determined that field "'+fieldNameToShow+'" should be hidden.');if(!$fieldToShow.is(".InputfieldStateHidden")){$fieldToShow.addClass("InputfieldStateHidden").hide();$(document).trigger("hideInputfield",$fieldToShow);consoleLog("Field is now hidden.");numVisibilityChanges++}else{consoleLog("Field is already hidden.")}if(required){consoleLog("Field is required but cancelling that since it is not visible.");required=false}}if(required&&requiredMatches>0){consoleLog('Determined that field "'+fieldNameToShow+'" should be required.');$fieldToShow.addClass("InputfieldStateRequired").find(":input:visible[type!=hidden]").addClass("required")}else if(!required&&notRequiredMatches>0){consoleLog('Determined that field "'+fieldNameToShow+'" should not be required.');$fieldToShow.removeClass("InputfieldStateRequired").find(":input.required").removeClass("required")}if(numVisibilityChanges>0){consoleLog(numVisibilityChanges+" visibility changes were made.");InputfieldColumnWidths();$(window).resize()}InputfieldDependenciesProcessing=false}function setupConditions(conditionType,conditions,$fieldToShow){var selector=$fieldToShow.attr("data-"+conditionType+"-if");if(!selector||selector.length<1){return conditions}selector=$("<div />").html(selector).text();consoleLog("-------------------------------------------------------------------");consoleLog('Analyzing "'+conditionType+'" selector: '+selector);var parts=selector.match(/(^|,)([^,]+)/g);for(var n=0;n<parts.length;n++){var part=parts[n];var match=part.match(/^[,\s]*([_.|a-zA-Z0-9]+)(=|!=|<=|>=|<|>|%=)([^,]+),?$/);if(!match)continue;var field=match[1];var operator=match[2];var value=match[3];var subfield="";var fields=[];var values=[];if(field.indexOf("|")>-1){consoleLog("OR field dependency: "+field);fields=field.split("|")}else{fields=[field]}var fieldAndSubfield=extractFieldAndSubfield(field);field=fieldAndSubfield.field;subfield=fieldAndSubfield.subfield;if(InputfieldDebugMode){consoleLog("Field: "+field);if(subfield.length)consoleLog("Subfield: "+subfield);consoleLog("Operator: "+operator);consoleLog("value: "+value)}if(value.indexOf("|")>-1){consoleLog("OR value dependency: "+value);values=value.split("|");for(var i=0;i<values.length;i++){values[i]=trimParseValue(values[i])}}else{values=[trimParseValue([value])]}var condition={type:conditionType,field:field,fields:fields,subfield:subfield,operator:operator,value:value,values:values};conditions[conditions.length]=condition;for(var fn=0;fn<fields.length;fn++){var fieldAndSubfield=extractFieldAndSubfield(fields[fn]);var f=fieldAndSubfield.field;var $inputfield=$("#Inputfield_"+f);if($inputfield.length==0){consoleLog("Unable to find inputfield by: #Inputfield_"+f);$inputfield=$("#"+f);if($inputfield.length==0)consoleLog("Unable to find inputfield by: #"+f)}if($inputfield.length==0){$inputfield=$("#wrap_Inputfield_"+f).find(":input");if($inputfield.length==0)consoleLog("Unable to find inputfield by: #wrap_Inputfield_"+f+" :input")}if($inputfield.length){consoleLog("Attaching change event for: "+$inputfield.attr("name"));$inputfield.change(function(){inputfieldChange(conditions,$fieldToShow)})}else{consoleLog("Failed to find inputfield, no change event attached")}}}return conditions}function setupDependencyField($fieldToShow){var conditions=[];conditions=setupConditions("show",conditions,$fieldToShow);conditions=setupConditions("required",conditions,$fieldToShow);inputfieldChange(conditions,$fieldToShow)}InputfieldDependenciesProcessing=true;$target.each(function(){$(this).find(".InputfieldStateShowIf, .InputfieldStateRequiredIf").each(function(){setupDependencyField($(this))})});InputfieldDependenciesProcessing=false}function InputfieldColumnWidths($target){var $=jQuery;var hasTarget=true;if(typeof $target=="undefined"){hasTarget=false;$target=$("form.InputfieldForm")}var colspacing=null;var useHeights=null;function getWidth($item){if($item.is(".InputfieldStateHidden"))return 0;var pct=$item.attr("data-colwidth");if(typeof pct=="undefined"||!pct.length){var style=$item.attr("style");if(typeof style=="undefined"||!style)return $item.width();var pct=parseInt(style.match(/width:\s*(\d+)/i)[1])}else{pct=parseInt(pct)}if(!$item.attr("data-original-width"))$item.attr("data-original-width",pct);return pct}function getOriginalWidth($item){var w=parseInt($item.attr("data-original-width"));if(w==0)w=getWidth($item);return w}function setWidth($item,pct,animate){$item.width(pct+"%");if(animate){$item.css("opacity",.5);$item.animate({opacity:1},150,function(){})}consoleLog("setWidth("+$item.attr("id")+": "+pct+"%")}function getHeight($item){return $item.height()}function setHeight($item,maxColHeight){var h=getHeight($item);consoleLog("setHeight: "+$item.find("label").text()+" >> "+maxColHeight+" ("+h+")");if(h==maxColHeight)return;if($item.hasClass("InputfieldStateCollapsed"))return;var pad=maxColHeight-h;if(pad<0)pad=0;var $container=$item.children(".InputfieldContent, .ui-widget-content");if(pad==0){}else{consoleLog("Adjusting "+$item.attr("id")+" from "+h+" to "+maxColHeight);var $spacer=$("<div class='maxColHeightSpacer'></div>");$container.append($spacer);$spacer.height(pad)}}function updateInputfieldRow($firstItem){var $items=$firstItem.nextUntil(".InputfieldColumnWidthFirst",".InputfieldColumnWidth:not(.InputfieldStateHidden)");var rowWidth=$firstItem.is(".InputfieldStateHidden")?0:getWidth($firstItem);var $item=$firstItem.is(".InputfieldStateHidden")?null:$firstItem;var itemWidth=$item==null?0:rowWidth;var numItems=$items.length;if($firstItem.is(".InputfieldStateHidden")){numItems--;var $leadItem=$items.eq(0)}else{var $leadItem=$firstItem}if(useHeights){$leadItem.find(".maxColHeightSpacer").remove();$items.find(".maxColHeightSpacer").remove()}var maxRowWidth=100-numItems*colspacing;var maxColHeight=useHeights?getHeight($leadItem):0;$items.removeClass("InputfieldColumnWidthFirstTmp");$items.each(function(){$item=$(this);itemWidth=getWidth($item);rowWidth+=itemWidth;if(useHeights){var h=getHeight($item);if(h>maxColHeight)maxColHeight=h}});if(useHeights){if(InputfieldDebugMode){var lab=$leadItem.find("label").text();consoleLog("maxColHeight: "+lab+" = "+maxColHeight)}if(maxColHeight>0){setHeight($leadItem,maxColHeight);$items.each(function(){setHeight($(this),maxColHeight)})}}if(rowWidth<maxRowWidth){consoleLog("Expand width of row because rowWidth < maxRowWidth ("+rowWidth+" < "+maxRowWidth+")");var leftoverWidth=maxRowWidth-rowWidth;consoleLog("leftoverWidth: "+leftoverWidth);itemWidth=itemWidth+leftoverWidth;if($item==null&&!$firstItem.is(".InputfieldStateHidden"))$item=$firstItem;if($item){var originalWidth=getOriginalWidth($item);if(originalWidth>0&&itemWidth<originalWidth)itemWidth=originalWidth;setWidth($item,itemWidth,true)}}else if(rowWidth>maxRowWidth){consoleLog("Reduce width of row because rowWidth > maxRowWidth ("+rowWidth+" > "+maxRowWidth+")");if(!$firstItem.is(".InputfieldStateHidden"))$items=$firstItem.add($items);rowWidth=0;$items.each(function(){$item=$(this);itemWidth=getOriginalWidth($item);if(itemWidth>0)setWidth($item,itemWidth,false);rowWidth+=itemWidth});var leftoverWidth=maxRowWidth-rowWidth;itemWidth+=leftoverWidth;var originalWidth=getOriginalWidth($item);if(originalWidth>0&&itemWidth<originalWidth)itemWidth=originalWidth;setWidth($item,itemWidth,false)}if($firstItem.is(".InputfieldStateHidden")){$leadItem.addClass("InputfieldColumnWidthFirstTmp")}}var numForms=0;$target.each(function(){var $form=$(this);if(!$form.hasClass("InputfieldForm")){var $_form=$form.closest(".InputfieldForm");if($_form.length)$form=$_form}if($form.hasClass("InputfieldFormNoWidths")){return}colspacing=$form.attr("data-colspacing");if(typeof colspacing=="undefined")colspacing=1;useHeights=$form.hasClass("InputfieldFormNoHeights")?false:true;$(".Inputfield:not(.InputfieldColumnWidth)",$form).addClass("InputfieldColumnWidthFirst");$(".InputfieldColumnWidthFirst.InputfieldColumnWidth:visible",$form).each(function(){updateInputfieldRow($(this))});numForms++});if(!numForms){}else if(!$("body").hasClass("InputfieldColumnWidthsInit")){$("body").addClass("InputfieldColumnWidthsInit")}}function InputfieldFormBeforeUnloadEvent(e){var $=jQuery;var $changes=$(".InputfieldFormConfirm:not(.InputfieldFormSubmitted) .InputfieldStateChanged");if($changes.length==0)return;var msg=$(".InputfieldFormConfirm:eq(0)").attr("data-confirm")+"\n";$changes.each(function(){var $header=$(this).find(".InputfieldHeader:eq(0)");if($header.length){name=$header.text()}else{name=$(this).attr("data-label");if(!name||!name.length){name=$(this).find(":input").attr("name")}}if(name.length)msg+="\nâ€¢ "+$.trim(name)});(e||window.event).returnValue=msg;return msg}function InputfieldFocus($inputfield){if(!$inputfield.hasClass("Inputfield"))$inputfield=$inputfield.closest(".Inputfield");if(!$inputfield.length)return;if($inputfield.hasClass("InputfieldStateCollapsed")||!$inputfield.is(":visible")){InputfieldToggle($inputfield,true,0,function($in,open,duration){InputfieldFocus($in)});return}var focused=false;if($inputfield.hasClass("InputfieldNoFocus")){}else{var $input=$inputfield.find(":input:visible:enabled:not(button):not(.InputfieldNoFocus):first");if($input.length){if($input.css("position")=="absolute"||$input.is("button")){}else{var t=$input.attr("type");if($input.is("textarea")||t=="text"||t=="email"||t=="url"||t=="number"){$input.focus();focused=true}}}}if(!focused){var pageTop=jQuery(window).scrollTop();var pageBottom=pageTop+jQuery(window).height();var inputTop=$inputfield.offset().top;var inputBottom=inputTop+$inputfield.height();var inView=inputTop<=pageBottom&&inputBottom>=pageTop;if(!inView)setTimeout(function(){jQuery("html, body").animate({scrollTop:$inputfield.offset().top-10},100)},100)}}function InputfieldToggle($inputfield,open,duration,completedCallback){if(!$inputfield.length)return;if(!$inputfield.hasClass("Inputfield"))$inputfield=$inputfield.closest(".Inputfield");var $header=$inputfield.children(".InputfieldHeader, .ui-widget-header");var $content=$inputfield.children(".InputfieldContent, .ui-widget-content");var $toggleIcon=$header.find(".toggle-icon");var isCollapsed=$inputfield.hasClass("InputfieldStateCollapsed");if($inputfield.hasClass("InputfieldAjaxLoading"))return false;if($inputfield.hasClass("InputfieldStateToggling"))return false;if(typeof open=="undefined"||open===null)var open=isCollapsed;if(typeof duration=="undefined")var duration=100;function completed(){if(typeof completedCallback!="undefined")completedCallback($inputfield,open,duration)}function toggled(){if($inputfield.css("overflow")=="hidden")$inputfield.css("overflow","");$toggleIcon.toggleClass($toggleIcon.attr("data-to"));$inputfield.removeClass("InputfieldStateToggling");setTimeout("InputfieldColumnWidths()",500);completed()}function opened(){$inputfield.trigger("opened");if($inputfield.hasClass("InputfieldColumnWidth")){$inputfield.children(".InputfieldContent").show()}if(!$inputfield.hasClass("InputfieldNoFocus"))InputfieldFocus($inputfield);toggled()}function closed(){if($inputfield.css("overflow")=="hidden")$inputfield.css("overflow","");$inputfield.trigger("closed");if($inputfield.hasClass("InputfieldColumnWidth")){$inputfield.children(".InputfieldContent").hide()}toggled()}if(open&&!$inputfield.is(":visible")){var $tabContent=$inputfield.parents(".InputfieldWrapper").last();if($tabContent.length&&!$tabContent.is(":visible")){var $tabButton=jQuery("#_"+$tabContent.attr("id"));if($tabButton.length){$tabContent.show();setTimeout(function(){$tabButton.click()},25)}}var $collapsedParent=$inputfield.closest(".InputfieldStateCollapsed");if($collapsedParent.length){InputfieldToggle($collapsedParent,true,duration,function($in){InputfieldToggle($in,true,duration,completedCallback)})}}if(open&&!isCollapsed){completed();return}if(!open&&isCollapsed){completed();return}if(isCollapsed&&($inputfield.hasClass("collapsed10")||$inputfield.hasClass("collapsed11"))){$toggleIcon.click();return}if(open&&isCollapsed){$inputfield.addClass("InputfieldStateToggling").trigger("openReady");$inputfield.toggleClass("InputfieldStateCollapsed",duration,opened)}else if(!open&&!isCollapsed){$inputfield.addClass("InputfieldStateToggling").trigger("closeReady");$inputfield.toggleClass("InputfieldStateCollapsed",duration,closed)}}function InputfieldOpen($inputfield,duration){InputfieldToggle($inputfield,true,duration)}function InputfieldClose($inputfield,duration){InputfieldToggle($inputfield,false,duration)}function InputfieldStates($target){var hasTarget=true;var $=jQuery;if(typeof $target=="undefined"){$target=$("body");hasTarget=false}function InputfieldStateAjaxClick($li){function headerHighlightEffect($header,$li){var $spinner=$("<i class='fa fa-spin fa-spinner'></i>");var offset=$header.offset();var interval;var maxRuns=10;var runs=0;var hAdjust=.8;$("body").append($spinner.hide());if($header.is("a")&&$header.closest("ul").hasClass("uk-tab"))hAdjust=.1;$spinner.css({position:"absolute",top:offset.top-($spinner.height()+5),left:offset.left+$header.width()/2+$spinner.width()*hAdjust}).fadeIn();interval=setInterval(function(){if(++runs>maxRuns||!$li.hasClass("InputfieldAjaxLoading")){clearInterval(interval);$spinner.fadeOut("normal",function(){$spinner.remove()})}},500)}var $parent=$li.children(".InputfieldContent").children(".renderInputfieldAjax");var isTab=false;if(!$parent.length){$parent=$li.children(".renderInputfieldAjax");isTab=true}var ajaxURL=$parent.children("input").attr("value");if(typeof ajaxURL=="undefined"||ajaxURL.length<1)return false;var $spinner=null;if(isTab){var $header=$("#_"+$li.attr("id"));headerHighlightEffect($header,$li)}else{var $header=$li.children(".InputfieldHeader");$spinner=$("<i class='fa fa-spin fa-spinner'></i>");$spinner.css("margin-left","0.5em");$header.append($spinner)}$li.removeClass("collapsed10 collapsed11").addClass("InputfieldAjaxLoading");$.get(ajaxURL,function(data){$li.removeClass("InputfieldAjaxLoading InputfieldStateCollapsed");var $icon=$li.children(".InputfieldHeader").find(".toggle-icon");if($icon.length)$icon.toggleClass($icon.attr("data-to"));$parent.replaceWith($(data)).hide();$parent.slideDown();var $inputfields=$li.find(".Inputfield");if($inputfields.length){$inputfields.trigger("reloaded",["InputfieldAjaxLoad"]);InputfieldStates($li);InputfieldRequirements($li);InputfieldColumnWidths()}else{$li.trigger("reloaded",["InputfieldAjaxLoad"]);InputfieldColumnWidths()}if($li.closest(".InputfieldFormNoDependencies").length==0){InputfieldDependencies($li.parent())}setTimeout(function(){if($spinner)$spinner.fadeOut("fast",function(){$spinner.remove()});if(isTab){$header.effect("highlight",500)}else{$header.click()}},500)},"html");return true}$(".Inputfield:not(.collapsed9) > .InputfieldHeader, .Inputfield:not(.collapsed9) > .ui-widget-header",$target).addClass("InputfieldStateToggle");var $icon=$(".Inputfields .InputfieldStateCollapsed > .InputfieldHeader i.toggle-icon, .Inputfields .InputfieldStateCollapsed > .ui-widget-header i.toggle-icon",$target);$icon.toggleClass($icon.attr("data-to"));if(typeof ProcessWire!="undefined"){var config=ProcessWire.config}if(typeof config!=="undefined"&&config.debug){$("label.InputfieldHeader > i.toggle-icon",$target).hover(function(){var $label=$(this).parent("label");if($label.length==0)return;var text=$label.attr("for").replace(/^Inputfield_/,"");if(text.length){var $tip=$("<small class='InputfieldNameTip ui-priority-secondary'>&nbsp;"+text+"&nbsp;</small>");$tip.css("float","right");$label.append($tip)}},function(){var $label=$(this).parent("label");if($label.length==0)return;$label.find(".InputfieldNameTip").remove()})}if(hasTarget)return;$(document).on("wiretabclick",function(e,$newTab,$oldTab){if($newTab.hasClass("collapsed10"))InputfieldStateAjaxClick($newTab)});$(document).on("click",".InputfieldStateToggle, .toggle-icon",function(event,data){var $t=$(this);var $li=$t.closest(".Inputfield");var isIcon=$t.hasClass("toggle-icon");var $icon=isIcon?$t:$li.children(".InputfieldHeader, .ui-widget-header").find(".toggle-icon");var isCollapsed=$li.hasClass("InputfieldStateCollapsed");var wasCollapsed=$li.hasClass("InputfieldStateWasCollapsed");var duration=100;if(!$li.length)return;if($li.hasClass("InputfieldAjaxLoading"))return false;if($li.hasClass("InputfieldStateToggling"))return false;if(typeof data!="undefined"){if(typeof data.duration!="undefined")duration=data.duration}if(isCollapsed&&($li.hasClass("collapsed10")||$li.hasClass("collapsed11"))){if(InputfieldStateAjaxClick($li))return false}if(isCollapsed||wasCollapsed||isIcon){$li.addClass("InputfieldStateWasCollapsed");InputfieldToggle($li,null,duration)}else{if(typeof jQuery.ui!="undefined"){var color1=$icon.css("color");var color2=$li.children(".InputfieldHeader, .ui-widget-header").css("color");$icon.css("color",color2);$icon.effect("pulsate",300,function(){$icon.css("color",color1)})}InputfieldFocus($li)}return false});$("#content .InputfieldFormFocusFirst:not(.InputfieldFormNoFocus)").find("input[type=text]:enabled:first:not(.hasDatepicker):not(.InputfieldNoFocus)").each(function(){var $t=$(this);if($t.val())return;if($t.offset().top<$(window).height()){window.setTimeout(function(){if($t.is(":visible"))$t.focus()},250)}});$(document).on("change",".InputfieldFormConfirm :input, .InputfieldFormConfirm .Inputfield",function(){var $this=$(this);if($this.hasClass("Inputfield")){if(!$this.hasClass("InputfieldIgnoreChanges"))$this.addClass("InputfieldStateChanged");return false}else{if($this.hasClass("InputfieldIgnoreChanges")||$this.closest(".InputfieldIgnoreChanges").length)return false;$this.closest(".Inputfield").addClass("InputfieldStateChanged")}});$(document).on("submit",".InputfieldFormConfirm",function(){$(this).addClass("InputfieldFormSubmitted")});$(document).on("dragenter",".InputfieldHasUpload.InputfieldStateCollapsed",function(e){var dt=e.originalEvent.dataTransfer;if(dt.types&&(dt.types.indexOf?dt.types.indexOf("Files")!==-1:dt.types.contains("Files"))){InputfieldOpen($(this))}});window.addEventListener("beforeunload",InputfieldFormBeforeUnloadEvent)}function InputfieldIntentions(){var $=jQuery;$(".InputfieldForm").each(function(){var $form=$(this);var numButtons=null;var $input=null;$form.submit(function(){if(!$(this).hasClass("nosubmit"))return;if(!$input)return;var $buttons=null;var $inputfields=$input.closest(".Inputfields");do{$buttons=$inputfields.find("input[type=submit]:visible, button[type=submit]:visible");if($buttons.length>0)break;$inputfields=$inputfields.parent().closest(".Inputfields")}while($inputfields.length>0);if($buttons.length>0){var $button=$buttons.eq(0);$("html, body").animate({scrollTop:$button.offset().top},"fast");$button.focus()}return false}).on("focus","input, select",function(){if(numButtons===null)numButtons=$form.find("input[type=submit], button[type=submit]").length;if(numButtons<2)return;$form.addClass("nosubmit");$input=$(this)}).on("blur","input, select",function(){$form.removeClass("nosubmit")})});if($("input[type=file]").length){$(document).on({dragover:function(){if($(this).is("input[type=file]"))return;return false},drop:function(){if($(this).is("input[type=file]"))return;return false}})}}var InputfieldWindowResizeQueued=false;function InputfieldWindowResizeActions1(){consoleLog("InputfieldWindowResizeActions1()");jQuery(".Inputfield").trigger("resized")}function InputfieldWindowResizeActions2(){consoleLog("InputfieldWindowResizeActions2()");InputfieldColumnWidths();InputfieldWindowResizeQueued=false}function InputfieldRequirements($target){jQuery(":input[required]",$target).on("invalid",function(){var $input=jQuery(this);InputfieldFocus(jQuery(this))})}function InputfieldReloadEvent(event,extraData){var $t=$(this);var $form=$t.closest("form");var fieldName=$t.attr("id").replace("wrap_Inputfield_","");var fnsx="";var url=$form.attr("action");if(fieldName.indexOf("_repeater")>0){var $repeaterItem=$t.closest(".InputfieldRepeaterItem");var pageID=$repeaterItem.attr("data-page");url=url.replace(/\?id=\d+/,"?id="+pageID);fnsx=$repeaterItem.attr("data-fnsx");fieldName=fieldName.replace(/_repeater\d+$/,"")}url+=url.indexOf("?")>-1?"&":"?";url+="field="+fieldName+"&reloadInputfieldAjax="+fieldName;if(fnsx.length)url+="&fnsx="+fnsx;if(typeof extraData!="undefined"){if(typeof extraData["queryString"]!="undefined"){url+="&"+extraData["queryString"]}}consoleLog("Inputfield reload: "+fieldName);$.get(url,function(data){var id=$t.attr("id");var $content=jQuery(data).find("#"+id).children(".InputfieldContent");if(!$content.length&&id.indexOf("_repeater")>-1){id="wrap_Inputfield_"+fieldName;$content=jQuery(data).find("#"+id).children(".InputfieldContent");if(!$content.length){console.log("Unable to find #"+$t.attr("id")+" in response from "+url)}}$t.children(".InputfieldContent").html($content.html());$t.trigger("reloaded",["reload"])});event.stopPropagation()}function InputfieldsInit($target){InputfieldStates($target);InputfieldDependencies($target);InputfieldRequirements($target);setTimeout(function(){InputfieldColumnWidths()},100)}jQuery(document).ready(function($){InputfieldStates();InputfieldDependencies($(".InputfieldForm:not(.InputfieldFormNoDependencies)"));InputfieldIntentions();setTimeout(function(){InputfieldColumnWidths()},100);var windowResized=function(){if(InputfieldWindowResizeQueued)return;InputfieldWindowResizeQueued=true;setTimeout("InputfieldWindowResizeActions1()",1e3);setTimeout("InputfieldWindowResizeActions2()",2e3)};$(window).resize(windowResized);$("ul.WireTabs > li > a").click(function(){if(InputfieldWindowResizeQueued)return;InputfieldWindowResizeQueued=true;setTimeout("InputfieldWindowResizeActions1()",250);setTimeout("InputfieldWindowResizeActions2()",500);return true});InputfieldRequirements($(".InputfieldForm"));$(document).on("reload",".Inputfield",InputfieldReloadEvent);if($(".InputfieldForm:not(.InputfieldFormNoWidths)").length){$(document).on("change",".InputfieldColumnWidth :input",function(){InputfieldColumnWidths();setTimeout(InputfieldColumnWidths,300)});$(document).on("AjaxUploadDone",".InputfieldFileList",function(){InputfieldColumnWidths()});$(document).on("heightChanged",".InputfieldColumnWidth",function(){InputfieldColumnWidths()})}});