var ProcessWireAdminTheme={init:function(){this.setupCloneButton(),ProcessWireAdmin.init(),this.setupSearch(),this.setupDropdowns(),this.setupSidebarNav(),this.setupSideBarState(),this.setupSideBarToggle();var e=$("body"),a=$("html");e.hasClass("hasWireTabs")&&0==$("ul.WireTabs").length&&e.removeClass("hasWireTabs"),$("#content").removeClass("pw-fouc-fix"),e.removeClass("pw-init").addClass("pw-ready"),a.removeClass("pw-init").addClass("pw-ready"),$("a.notice-remove","#notices").click(function(){$("#notices").slideUp("fast",function(){return $(this).remove(),!1})})},setupSidebarNav:function(){function e(){$("#main-nav > li > a.open:not(.hover-temp):not(.just-clicked)").each(function(){var e=$(this),a=e.next("ul:visible");a.length>0&&a.find(".quicklinks-open").length>0&&a.find(".quicklink-close").click()})}var a=window.location.toString();$(document).mouseup(function(e){var a=$("ul.quicklinks");a.is(e.target)||0!==a.has(e.target).length||(a.hide(),$(".quicklink-open").removeClass("active"),$("#main-nav .current").removeClass("no-arrow"))}),$(document).keydown(function(e){var a,t=e.target.tagName.toLowerCase(),s=e.target.className.split(" ")[0];if("input"!=t&&"textarea"!=t&&"InputfieldCKEditorInline"!=s){switch(e.which){case 37:a="open";break;case 39:a="closed";break;default:return}ProcessWireAdminTheme.setupSideBarState(!0,a),e.preventDefault()}});var t=null,s=0;$("#main-nav a.parent").dblclick(function(e){e.preventDefault()}).click(function(){var a=$(this);return a.addClass("just-clicked"),s++,1!==s?(clearTimeout(t),s=0,window.location.href=a.attr("href"),!0):(t=setTimeout(function(){e(),a.toggleClass("open").next("ul").slideToggle(200,function(){a.removeClass("just-clicked")}),s=0},200),!1)});var n=null;$(".quicklink-open").click(function(a){e();var t=$(this);t.parent().addClass("quicklinks-open"),t.toggleClass("active").parent().next("ul.quicklinks").toggle(),t.parent().parent().siblings().find("ul.quicklinks").hide(),t.parent().parent().siblings().find(".quicklink-open").removeClass("active").parent("a").removeClass("quicklinks-open"),t.effect("pulsate",100),a.stopPropagation(),$("#main-nav .current:not(.open)").addClass("no-arrow");var s=$(this).parent().next("ul.quicklinks"),n=s.attr("data-json");if(n.length>0&&!s.hasClass("json-loaded")){s.addClass("json-loaded");var i=s.find(".quicklinks-spinner"),o=i.attr("class");i.removeClass(o).addClass("fa fa-fw fa-spin fa-spinner"),$.getJSON(n,function(e){if(e.add){var a=$("<li class='add'><a href='"+e.url+e.add.url+"'><i class='fa fa-fw fa-"+e.add.icon+"'></i>"+e.add.label+"</a></li>");s.append(a)}$.each(e.list,function(a){var t="",n=0===this.url.indexOf("/")?this.url:e.url+this.url,i=$("<li><a style='white-space:nowrap' href='"+n+"'>"+t+this.label+"</a></li>");"undefined"!=typeof this.className&&this.className&&this.className.length&&i.addClass(this.className),s.append(i)}),i.removeClass("fa-spin fa-spinner").addClass(o),e.icon.length>0&&i.removeClass("fa-bolt").addClass("fa-"+e.icon)})}return!1}).mouseover(function(){var e=$(this);e.parent().hasClass("quicklinks-open")||(e.addClass("hover-temp"),clearTimeout(n),n=setTimeout(function(){e.parent().hasClass("quicklinks-open")||e.hasClass("hover-temp")&&e.click()},500))}).mouseout(function(){$(this).removeClass("hover-temp")}),$(".quicklink-close").click(function(){return $(this).parent().removeClass("quicklinks-open"),$(this).closest("ul.quicklinks").hide().prev("a").removeClass("quicklinks-open"),$(".quicklink-open").removeClass("active"),$("#main-nav .current").removeClass("no-arrow"),!1}),$("#main-nav .parent").each(function(){var e=$(this).attr("href");a.match(e)&&($(this).next("ul").show(),$(this).addClass("open"))})},setupCloneButton:function(){if(!$("body").is(".modal")){var e=$("button.pw-head-button, button.head_button_clone");if(0!=e.length&&!$.browser.msie){var a=$("<div id='head_button'></div>").prependTo("#headline").show();e.each(function(){var e,t=$(this),s=t.parent("a");s.length?(e=t.parent("a").clone(),a.append(e)):(t.hasClass("head_button_clone")||t.hasClass("pw-head-button"))&&(e=t.clone(),e.attr("data-from_id",t.attr("id")).attr("id",t.attr("id")+"_copy"),e.click(function(){return $("#"+$(this).attr("data-from_id")).click(),!1}),a.prepend(e))})}}},setupSearch:function(){$.widget("custom.adminsearchautocomplete",$.ui.autocomplete,{_renderMenu:function(e,a){var t=this,s="";$.each(a,function(a,n){n.type!=s&&(e.append("<li class='ui-widget-header'><a>"+n.type+"</a></li>"),s=n.type),e.attr("id","ProcessPageSearchAutocomplete"),t._renderItemData(e,n)})},_renderItemData:function(e,a){a.label==a.template&&(a.template=""),e.append("<li><a href='"+a.edit_url+"'>"+a.label+" <small>"+a.template+"</small></a></li>")}});var e=$("#ProcessPageSearchQuery"),a=$("#ProcessPageSearchStatus");e.adminsearchautocomplete({minLength:2,position:{my:"right top",at:"right bottom"},search:function(e,t){a.html("<i class='fa fa-spinner fa-spin'></i>")},source:function(t,s){var n=e.parents("form").attr("action")+"for?get=template_label,title&include=all&admin_search="+t.term;$.getJSON(n,function(e){var t=e.matches.length;t<e.total?a.text(e.matches.length+"/"+e.total):a.text(t),s($.map(e.matches,function(e){return{label:e.title,value:e.title,page_id:e.id,template:e.template_label?e.template_label:"",edit_url:e.editUrl,type:e.type}}))})},select:function(e,a){}}).blur(function(){a.text("")});var t=$("#search");e.bind("keypress keydown keyup",function(e){13==e.keyCode&&e.preventDefault(),8==e.keyCode&&""==$.trim($(this).val())&&a.text("")}),$(".search-toggle").on("click",function(){return t.hasClass("open")?e.blur():($("#masthead").find("ul.open").removeClass("open"),e.focus()),t.toggleClass("open"),e.val(""),!1}),$(".search-close").on("click",function(){return t.removeClass("open"),e.val(""),e.blur(),!1}),$("body").click(function(a){if(t.hasClass("open")){var s=!0,n=["ProcessPageSearchAutocomplete","ProcessPageSearchForm","search"];-1==$.inArray(a.target.id,n)&&($.each(n,function(e,t){$(a.target).closest("#"+t).length&&(s=!1)}),s&&(t.removeClass("open"),e.val(""),e.blur()))}})},setupDropdowns:function(){$("#masthead li.pw-dropdown > a").on("click",function(e){return $(this).next("ul").toggleClass("open"),$(this).parent().siblings().find("ul.open").removeClass("open"),!1}),$("#masthead li.pw-dropdown > ul li a").on("click",function(e){e.stopPropagation()}),$(document).on("click",function(){$("#masthead li.pw-dropdown ul").removeClass("open")})},setupSideBarToggle:function(){$(".main-nav-toggle").on("click",function(){return ProcessWireAdminTheme.setupSideBarState(!0),!1})},setupSideBarState:function(e,a){if($("body").hasClass("id-23")||$("body").hasClass("modal"))return!1;var t="pw_sidebar_state",a=a||localStorage.getItem(t),s=$(".main-nav-toggle"),n=$("#sidebar"),i=$("#main"),o=$("#masthead"),l=$("#branding"),r=$("#NotificationBug"),c=s.add(n).add(i).add(o).add(l).add(r);null===a&&$(window).width()>=690&&localStorage.setItem(t,"open"),!e&&$(window).width()<690&&(localStorage.setItem(t,"closed"),a="closed"),1==e?("open"==a?(localStorage.setItem(t,"closed"),c.addClass("closed")):"closed"==a&&(localStorage.setItem(t,"open"),c.removeClass("closed")),n.removeClass("hide"),l.removeClass("hide"),i.removeClass("full"),o.removeClass("full"),s.removeClass("full")):"closed"==a&&(c.addClass("closed"),n.addClass("hide"),l.addClass("hide"),i.addClass("full"),o.addClass("full"),s.addClass("full"))},browserCheck:function(){$.browser.msie&&$.browser.version<8&&$("#content .pw-container").html("<h2>ProcessWire does not support IE7 and below at this time. Please try again with a newer browser.</h2>").show()}};$(document).ready(function(){ProcessWireAdminTheme.init()});