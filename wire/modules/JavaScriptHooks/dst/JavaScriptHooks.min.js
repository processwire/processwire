;if(typeof ProcessWire=="undefined")ProcessWire={};document.addEventListener("HooksHelper:ready",(e)=>{const HooksHelper=e.detail;ProcessWire.wire=HooksHelper.wire.bind(HooksHelper);ProcessWire.addHookAfter=HooksHelper.addHookAfter.bind(HooksHelper);ProcessWire.addHookBefore=HooksHelper.addHookBefore.bind(HooksHelper)});class HookEvent{constructor(data){this.object=data.object;this.args=data.arguments;this.replace=!1;this.return=data.return}
get arguments(){const self=this;return new Proxy(function(){if(arguments.length===0)return self.args;if(arguments.length===1)return self.args[arguments[0]];if(arguments.length===2)self.args[arguments[0]]=arguments[1]},{get(target,prop){if(prop==="length")return self.args.length;const index=parseInt(prop,10);return isNaN(index)?undefined:self.args[index]},set(target,prop,value){const index=parseInt(prop,10);if(!isNaN(index)){self.args[index]=value;return!0}
return!1},})}};class HooksHelper{hooks={after:{},before:{},};addHookAfter(name,fn,priority=100){const _hooks=this.hooks.after[name]||[];_hooks.push({name,fn,priority});_hooks.sort((a,b)=>a.priority-b.priority);this.hooks.after[name]=_hooks}
addHookBefore(name,fn,priority=100){const _hooks=this.hooks.before[name]||[];_hooks.push({name,fn,priority});_hooks.sort((a,b)=>a.priority-b.priority);this.hooks.before[name]=_hooks}
executeHooks(type,hookName,hookEvent){const _hooks=this.hooks[type][hookName]||[];for(let i=0;i<_hooks.length;i++){try{_hooks[i].fn(hookEvent);if(hookEvent.replace&&type==="before")break}catch(error){console.error(`Error in ${type} hook for ${hookName}:`,error);console.log("Hook:",_hooks[i]);console.log("HookEvent:",hookEvent)}}}
hookHandler(){const self=this;return{get:function(data,prop){const object=data.object;if(typeof prop!=="string")return object[prop];let hookObjectName=data.name;if(!hookObjectName)hookObjectName=object.constructor.name;const selector=`${hookObjectName}::${prop}`;if(prop.startsWith("___"))return object[prop];if(typeof object[`___${prop}`]==="undefined")return object[prop];return function(...args){const hookEvent=new HookEvent({arguments:args,object:this,});self.executeHooks("before",selector,hookEvent);if(hookEvent.replace)return hookEvent.return;hookEvent.return=object[`___${prop}`].apply(this,hookEvent.arguments());self.executeHooks("after",selector,hookEvent);return hookEvent.return}},}}
wire(object,name=null,noProxy=!1){if(object.constructor.name!=="Object"){name=object.constructor.name}
if(!name){throw new Error("Please provide a name: ProcessWire.wire(object, name)")}
if(object.constructor.name==="Object")noProxy=!0;if(noProxy)return this.wireNoProxy(object,name);else return this.wireProxy(object,name)}
wireNoProxy(object,name){const self=this;let props=Object.getOwnPropertyDescriptors(object);for(let key in props){if(!key.startsWith("___"))continue;const originalMethod=props[key].value;if(typeof originalMethod!=="function")continue;let newMethod=key.slice(3);const hookName=`${name}::${newMethod}`;props[newMethod]={value:function(...args){const hookEvent=new HookEvent({arguments:args,object:this,});self.executeHooks("before",hookName,hookEvent);if(hookEvent.replace)return hookEvent.return;hookEvent.return=originalMethod.apply(this,hookEvent.arguments());self.executeHooks("after",hookName,hookEvent);return hookEvent.return},}}
return Object.create(Object.getPrototypeOf(object),props)}
wireProxy(object,name){return new Proxy({object:object,name:name,},this.hookHandler())}}
document.dispatchEvent(new CustomEvent("HooksHelper:ready",{detail:new HooksHelper()}))