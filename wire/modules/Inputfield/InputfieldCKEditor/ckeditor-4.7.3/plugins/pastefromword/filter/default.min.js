(function(){function j(){return !1}function f(m,g){var r,q=[];m.filterChildren(g);for(r=m.children.length-1;0<=r;r--){q.unshift(m.children[r]),m.children[r].remove()}r=m.attributes;var o=m,p=!0,n;for(n in r){if(p){p=!1}else{var k=new CKEDITOR.htmlParser.element(m.name);k.attributes[n]=r[n];o.add(k);o=k;delete r[n]}}for(r=0;r<q.length;r++){o.add(q[r])}}var d,c,l,a,b=CKEDITOR.tools,e=["o:p","xml","script","meta","link"],h={},i=0;CKEDITOR.plugins.pastefromword={};CKEDITOR.cleanWord=function(k,g){var o=Boolean(k.match(/mso-list:\s*l\d+\s+level\d+\s+lfo\d+/));CKEDITOR.plugins.clipboard.isCustomDataTypesSupported&&(k=CKEDITOR.plugins.pastefromword.styles.inliner.inline(k).getBody().getHtml());k=k.replace(/<!\[/g,"\x3c!--[").replace(/\]>/g,"]--\x3e");var n=CKEDITOR.htmlParser.fragment.fromHtml(k);a=new CKEDITOR.htmlParser.filter({root:function(p){p.filterChildren(a);CKEDITOR.plugins.pastefromword.lists.cleanup(d.createLists(p))},elementNames:[[/^\?xml:namespace$/,""],[/^v:shapetype/,""],[new RegExp(e.join("|")),""]],elements:{a:function(q){if(q.attributes.name){if("_GoBack"==q.attributes.name){delete q.name;return}if(q.attributes.name.match(/^OLE_LINK\d+$/)){delete q.name;return}}if(q.attributes.href&&q.attributes.href.match(/#.+$/)){var p=q.attributes.href.match(/#(.+)$/)[1];h[p]=q}q.attributes.name&&h[q.attributes.name]&&(q=h[q.attributes.name],q.attributes.href=q.attributes.href.replace(/.*#(.*)$/,"#$1"))},div:function(p){c.createStyleStack(p,a,g)},img:function(q){if(q.parent&&q.parent.attributes){var p=q.parent.attributes;(p=p.style||p.STYLE)&&p.match(/mso\-list:\s?Ignore/)&&(q.attributes["cke-ignored"]=!0)}c.mapStyles(q,{width:function(r){c.setStyle(q,"width",r+"px")},height:function(r){c.setStyle(q,"height",r+"px")}});q.attributes.src&&q.attributes.src.match(/^file:\/\//)&&q.attributes.alt&&q.attributes.alt.match(/^https?:\/\//)&&(q.attributes.src=q.attributes.alt)},p:function(p){p.filterChildren(a);if(p.attributes.style&&p.attributes.style.match(/display:\s*none/i)){return !1}if(d.thisIsAListItem(g,p)){l.isEdgeListItem(g,p)&&l.cleanupEdgeListItem(p),d.convertToFakeListItem(g,p),b.array.reduce(p.children,function(t,s){"p"===s.name&&(0<t&&(new CKEDITOR.htmlParser.element("br")).insertBefore(s),s.replaceWithChildren(),t+=1);return t},0)}else{var r=p.getAscendant(function(s){return"ul"==s.name||"ol"==s.name}),q=b.parseCssText(p.attributes.style);r&&!r.attributes["cke-list-level"]&&q["mso-list"]&&q["mso-list"].match(/level/)&&(r.attributes["cke-list-level"]=q["mso-list"].match(/level(\d+)/)[1]);g.config.enterMode==CKEDITOR.ENTER_BR&&(delete p.name,p.add(new CKEDITOR.htmlParser.element("br")))}c.createStyleStack(p,a,g)},pre:function(p){d.thisIsAListItem(g,p)&&d.convertToFakeListItem(g,p);c.createStyleStack(p,a,g)},h1:function(p){d.thisIsAListItem(g,p)&&d.convertToFakeListItem(g,p);c.createStyleStack(p,a,g)},h2:function(p){d.thisIsAListItem(g,p)&&d.convertToFakeListItem(g,p);c.createStyleStack(p,a,g)},h3:function(p){d.thisIsAListItem(g,p)&&d.convertToFakeListItem(g,p);c.createStyleStack(p,a,g)},h4:function(p){d.thisIsAListItem(g,p)&&d.convertToFakeListItem(g,p);c.createStyleStack(p,a,g)},h5:function(p){d.thisIsAListItem(g,p)&&d.convertToFakeListItem(g,p);c.createStyleStack(p,a,g)},h6:function(p){d.thisIsAListItem(g,p)&&d.convertToFakeListItem(g,p);c.createStyleStack(p,a,g)},font:function(p){if(p.getHtml().match(/^\s*$/)){return(new CKEDITOR.htmlParser.text(" ")).insertAfter(p),!1}g&&!0===g.config.pasteFromWordRemoveFontStyles&&p.attributes.size&&delete p.attributes.size;CKEDITOR.dtd.tr[p.parent.name]&&CKEDITOR.tools.arrayCompare(CKEDITOR.tools.objectKeys(p.attributes),["class","style"])?c.createStyleStack(p,a,g):f(p,a)},ul:function(p){if(o){return"li"==p.parent.name&&0===b.indexOf(p.parent.children,p)&&c.setStyle(p.parent,"list-style-type","none"),d.dissolveList(p),!1}},li:function(p){l.correctLevelShift(p);o&&(p.attributes.style=c.normalizedStyles(p,g),c.pushStylesLower(p))},ol:function(p){if(o){return"li"==p.parent.name&&0===b.indexOf(p.parent.children,p)&&c.setStyle(p.parent,"list-style-type","none"),d.dissolveList(p),!1}},span:function(p){p.filterChildren(a);p.attributes.style=c.normalizedStyles(p,g);if(!p.attributes.style||p.attributes.style.match(/^mso\-bookmark:OLE_LINK\d+$/)||p.getHtml().match(/^(\s|&nbsp;)+$/)){for(var q=p.children.length-1;0<=q;q--){p.children[q].insertAfter(p)}return !1}p.attributes.style.match(/FONT-FAMILY:\s*Symbol/i)&&p.forEach(function(r){r.value=r.value.replace(/&nbsp;/g,"")},CKEDITOR.NODE_TEXT,!0);c.createStyleStack(p,a,g)},table:function(q){q._tdBorders={};q.filterChildren(a);var p,s=0,r;for(r in q._tdBorders){q._tdBorders[r]>s&&(s=q._tdBorders[r],p=r)}c.setStyle(q,"border",p);s=(p=q.parent)&&p.parent;if(p.name&&"div"===p.name&&p.attributes.align&&1===b.objectKeys(p.attributes).length&&1===p.children.length){q.attributes.align=p.attributes.align;r=p.children.splice(0);q.remove();for(q=r.length-1;0<=q;q--){s.add(r[q],p.getIndex())}p.remove()}},td:function(r){var v=r.getAscendant("table"),u=v._tdBorders,s=["border","border-top","border-right","border-bottom","border-left"],v=b.parseCssText(v.attributes.style),q=v.background||v.BACKGROUND;q&&c.setStyle(r,"background",q,!0);(v=v["background-color"]||v["BACKGROUND-COLOR"])&&c.setStyle(r,"background-color",v,!0);var v=b.parseCssText(r.attributes.style),t;for(t in v){q=v[t],delete v[t],v[t.toLowerCase()]=q}for(t=0;t<s.length;t++){v[s[t]]&&(q=v[s[t]],u[q]=u[q]?u[q]+1:1)}c.createStyleStack(r,a,g,/margin|text\-align|padding|list\-style\-type|width|height|border|white\-space|vertical\-align|background/i)},"v:imagedata":j,"v:shape":function(q){var p=!1;q.parent.getFirst(function(s){"img"==s.name&&s.attributes&&s.attributes["v:shapes"]==q.attributes.id&&(p=!0)});if(p){return !1}var r="";q.forEach(function(s){s.attributes&&s.attributes.src&&(r=s.attributes.src)},CKEDITOR.NODE_ELEMENT,!0);q.filterChildren(a);q.name="img";q.attributes.src=q.attributes.src||r;delete q.attributes.type},style:function(){return !1},object:function(p){return !(!p.attributes||!p.attributes.data)}},attributes:{style:function(p,q){return c.normalizedStyles(q,g)||!1},"class":function(p){p=p.replace(/(el\d+)|(font\d+)|msonormal|msolistparagraph\w*/ig,"");return""===p?!1:p},cellspacing:j,cellpadding:j,border:j,"v:shapes":j,"o:spid":j},comment:function(p){p.match(/\[if.* supportFields.*\]/)&&i++;"[endif]"==p&&(i=0<i?i-1:0);return !1},text:function(q,p){if(i){return""}var r=p.parent&&p.parent.parent;return r&&r.attributes&&r.attributes.style&&r.attributes.style.match(/mso-list:\s*ignore/i)?q.replace(/&nbsp;/g," "):q}});var m=new CKEDITOR.htmlParser.basicWriter;a.applyTo(n);n.writeHtml(m);return m.getHtml()};CKEDITOR.plugins.pastefromword.styles={setStyle:function(k,g,o,n){var m=b.parseCssText(k.attributes.style);n&&m[g]||(""===o?delete m[g]:m[g]=o,k.attributes.style=CKEDITOR.tools.writeCssText(m))},mapStyles:function(k,g){for(var m in g){if(k.attributes[m]){if("function"===typeof g[m]){g[m](k.attributes[m])}else{c.setStyle(k,g[m],k.attributes[m])}delete k.attributes[m]}}},normalizedStyles:function(z,y){var x="background-color:transparent border-image:none color:windowtext direction:ltr mso- text-indent visibility:visible div:border:none".split(" "),w="font-family font font-size color background-color line-height text-decoration".split(" "),u=function(){for(var m=[],k=0;k<arguments.length;k++){arguments[k]&&m.push(arguments[k])}return -1!==b.indexOf(x,m.join(":"))},v=y&&!0===y.config.pasteFromWordRemoveFontStyles,t=b.parseCssText(z.attributes.style);"cke:li"==z.name&&t["TEXT-INDENT"]&&t.MARGIN&&(z.attributes["cke-indentation"]=d.getElementIndentation(z),t.MARGIN=t.MARGIN.replace(/(([\w\.]+ ){3,3})[\d\.]+(\w+$)/,"$10$3"));for(var q=b.objectKeys(t),g=0;g<q.length;g++){var o=q[g].toLowerCase(),n=t[q[g]],s=CKEDITOR.tools.indexOf;(v&&-1!==s(w,o.toLowerCase())||u(null,o,n)||u(null,o.replace(/\-.*$/,"-"))||u(null,o)||u(z.name,o,n)||u(z.name,o.replace(/\-.*$/,"-"))||u(z.name,o)||u(n))&&delete t[q[g]]}return CKEDITOR.tools.writeCssText(t)},createStyleStack:function(m,g,r,q){var o=[];m.filterChildren(g);for(g=m.children.length-1;0<=g;g--){o.unshift(m.children[g]),m.children[g].remove()}c.sortStyles(m);g=b.parseCssText(c.normalizedStyles(m,r));r=m;var p="span"===m.name,n;for(n in g){if(!n.match(q||/margin|text\-align|width|border|padding/i)){if(p){p=!1}else{var k=new CKEDITOR.htmlParser.element("span");k.attributes.style=n+":"+g[n];r.add(k);r=k;delete g[n]}}}CKEDITOR.tools.isEmpty(g)?delete m.attributes.style:m.attributes.style=CKEDITOR.tools.writeCssText(g);for(g=0;g<o.length;g++){r.add(o[g])}},sortStyles:function(k){for(var g=["border","border-bottom","font-size","background"],q=b.parseCssText(k.attributes.style),p=b.objectKeys(q),n=[],o=[],m=0;m<p.length;m++){-1!==b.indexOf(g,p[m].toLowerCase())?n.push(p[m]):o.push(p[m])}n.sort(function(r,u){var t=b.indexOf(g,r.toLowerCase()),s=b.indexOf(g,u.toLowerCase());return t-s});p=[].concat(n,o);n={};for(m=0;m<p.length;m++){n[p[m]]=q[p[m]]}k.attributes.style=CKEDITOR.tools.writeCssText(n)},pushStylesLower:function(v,u,t){if(!v.attributes.style||0===v.children.length){return !1}u=u||{};var s={"list-style-type":!0,width:!0,height:!0,border:!0,"border-":!0},q=b.parseCssText(v.attributes.style),r;for(r in q){if(!(r.toLowerCase() in s||s[r.toLowerCase().replace(/\-.*$/,"-")]||r.toLowerCase() in u)){for(var o=!1,n=0;n<v.children.length;n++){var p=v.children[n];if(p.type===CKEDITOR.NODE_TEXT&&t){var k=new CKEDITOR.htmlParser.element("span");k.setHtml(p.value);p.replaceWith(k);p=k}p.type===CKEDITOR.NODE_ELEMENT&&(o=!0,c.setStyle(p,r,q[r]))}o&&delete q[r]}}v.attributes.style=CKEDITOR.tools.writeCssText(q);return !0},inliner:{filtered:"break-before break-after break-inside page-break page-break-before page-break-after page-break-inside".split(" "),parse:function(k){function g(s){var r=new CKEDITOR.dom.element("style"),t=new CKEDITOR.dom.element("iframe");t.hide();CKEDITOR.document.getBody().append(t);t.$.contentDocument.documentElement.appendChild(r.$);r.$.textContent=s;t.remove();return r.$.sheet}function q(s){var r=s.indexOf("{"),t=s.indexOf("}");return p(s.substring(r+1,t),!0)}var p=CKEDITOR.tools.parseCssText,n=CKEDITOR.plugins.pastefromword.styles.inliner.filter,o=k.is?k.$.sheet:g(k);k=[];var m;if(o){for(o=o.cssRules,m=0;m<o.length;m++){o[m].type===window.CSSRule.STYLE_RULE&&k.push({selector:o[m].selectorText,styles:n(q(o[m].cssText))})}}return k},filter:function(k){var g=CKEDITOR.plugins.pastefromword.styles.inliner.filtered,o=b.array.indexOf,n={},m;for(m in k){-1===o(g,m)&&(n[m]=k[m])}return n},sort:function(g){return g.sort(function(k){var m=CKEDITOR.tools.array.map(k,function(n){return n.selector});return function(o,n){var p=-1!==(""+o.selector).indexOf(".")?1:0,p=(-1!==(""+n.selector).indexOf(".")?1:0)-p;return 0!==p?p:m.indexOf(n.selector)-m.indexOf(o.selector)}}(g))},inline:function(k){var g=CKEDITOR.plugins.pastefromword.styles.inliner.parse,n=CKEDITOR.plugins.pastefromword.styles.inliner.sort,m=function(o){o=(new DOMParser).parseFromString(o,"text/html");return new CKEDITOR.dom.document(o)}(k);k=m.find("style");n=n(function(o){var q=[],p;for(p=0;p<o.count();p++){q=q.concat(g(o.getItem(p)))}return q}(k));CKEDITOR.tools.array.forEach(n,function(p){var o=p.styles;p=m.find(p.selector);var t,s,q;for(q=0;q<p.count();q++){t=p.getItem(q),s=CKEDITOR.tools.parseCssText(t.getAttribute("style")),s=CKEDITOR.tools.extend({},s,o),t.setAttribute("style",CKEDITOR.tools.writeCssText(s))}});return m}}};c=CKEDITOR.plugins.pastefromword.styles;CKEDITOR.plugins.pastefromword.lists={thisIsAListItem:function(k,g){return l.isEdgeListItem(k,g)||g.attributes.style&&g.attributes.style.match(/mso\-list:\s?l\d/)&&"li"!==g.parent.name||g.attributes["cke-dissolved"]||g.getHtml().match(/<!\-\-\[if !supportLists]\-\->/)?!0:!1},convertToFakeListItem:function(k,g){l.isDegenerateListItem(k,g)&&l.assignListLevels(k,g);this.getListItemInfo(g);if(!g.attributes["cke-dissolved"]){var n;g.forEach(function(o){!n&&"img"==o.name&&o.attributes["cke-ignored"]&&"*"==o.attributes.alt&&(n="·",o.remove())},CKEDITOR.NODE_ELEMENT);g.forEach(function(o){n||o.value.match(/^ /)||(n=o.value)},CKEDITOR.NODE_TEXT);if("undefined"==typeof n){return}g.attributes["cke-symbol"]=n.replace(/(?: |&nbsp;).*$/,"");d.removeSymbolText(g)}if(g.attributes.style){var m=b.parseCssText(g.attributes.style);m["margin-left"]&&(delete m["margin-left"],g.attributes.style=CKEDITOR.tools.writeCssText(m))}g.name="cke:li"},convertToRealListItems:function(k){var g=[];k.forEach(function(m){"cke:li"==m.name&&(m.name="li",g.push(m))},CKEDITOR.NODE_ELEMENT,!1);return g},removeSymbolText:function(k){var g,m=k.attributes["cke-symbol"];k.forEach(function(n){!g&&n.value.match(m.replace(")","\\)").replace("(",""))&&(n.value=n.value.replace(m,""),n.parent.getHtml().match(/^(\s|&nbsp;)*$/)&&(g=n.parent!==k?n.parent:null))},CKEDITOR.NODE_TEXT);g&&g.remove()},setListSymbol:function(k,g,p){p=p||1;var o=b.parseCssText(k.attributes.style);if("ol"==k.name){if(k.attributes.type||o["list-style-type"]){return}var m={"[ivx]":"lower-roman","[IVX]":"upper-roman","[a-z]":"lower-alpha","[A-Z]":"upper-alpha","\\d":"decimal"},n;for(n in m){if(d.getSubsectionSymbol(g).match(new RegExp(n))){o["list-style-type"]=m[n];break}}k.attributes["cke-list-style-type"]=o["list-style-type"]}else{m={"·":"disc",o:"circle","§":"square"},!o["list-style-type"]&&m[g]&&(o["list-style-type"]=m[g])}d.setListSymbol.removeRedundancies(o,p);(k.attributes.style=CKEDITOR.tools.writeCssText(o))||delete k.attributes.style},setListStart:function(k){for(var g=[],n=0,m=0;m<k.children.length;m++){g.push(k.children[m].attributes["cke-symbol"]||"")}g[0]||n++;switch(k.attributes["cke-list-style-type"]){case"lower-roman":case"upper-roman":k.attributes.start=d.toArabic(d.getSubsectionSymbol(g[n]))-n;break;case"lower-alpha":case"upper-alpha":k.attributes.start=d.getSubsectionSymbol(g[n]).replace(/\W/g,"").toLowerCase().charCodeAt(0)-96-n;break;case"decimal":k.attributes.start=parseInt(d.getSubsectionSymbol(g[n]),10)-n||1}"1"==k.attributes.start&&delete k.attributes.start;delete k.attributes["cke-list-style-type"]},numbering:{toNumber:function(k,g){function n(p){p=p.toUpperCase();for(var o=1,q=1;0<p.length;q*=26){o+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(p.charAt(p.length-1))*q,p=p.substr(0,p.length-1)}return o}function m(r){var q=[[1000,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]];r=r.toUpperCase();for(var v=q.length,u=0,s=0;s<v;++s){for(var o=q[s],t=o[1].length;r.substr(0,t)==o[1];r=r.substr(t)){u+=o[0]}}return u}return"decimal"==g?Number(k):"upper-roman"==g||"lower-roman"==g?m(k.toUpperCase()):"lower-alpha"==g||"upper-alpha"==g?n(k):1},getStyle:function(k){k=k.slice(0,1);var g={i:"lower-roman",v:"lower-roman",x:"lower-roman",l:"lower-roman",m:"lower-roman",I:"upper-roman",V:"upper-roman",X:"upper-roman",L:"upper-roman",M:"upper-roman"}[k];g||(g="decimal",k.match(/[a-z]/)&&(g="lower-alpha"),k.match(/[A-Z]/)&&(g="upper-alpha"));return g}},getSubsectionSymbol:function(g){return(g.match(/([\da-zA-Z]+).?$/)||["placeholder","1"])[1]},setListDir:function(k){var g=0,m=0;k.forEach(function(n){"li"==n.name&&("rtl"==(n.attributes.dir||n.attributes.DIR||"").toLowerCase()?m++:g++)},CKEDITOR.ELEMENT_NODE);m>g&&(k.attributes.dir="rtl")},createList:function(g){return(g.attributes["cke-symbol"].match(/([\da-np-zA-NP-Z]).?/)||[])[1]?new CKEDITOR.htmlParser.element("ol"):new CKEDITOR.htmlParser.element("ul")},createLists:function(z){var y,x,w,u=d.convertToRealListItems(z);if(0===u.length){return[]}var v=d.groupLists(u);for(z=0;z<v.length;z++){var t=v[z],r=t[0];for(w=0;w<t.length;w++){if(1==t[w].attributes["cke-list-level"]){r=t[w];break}}var r=[d.createList(r)],s=r[0],q=[r[0]];s.insertBefore(t[0]);for(w=0;w<t.length;w++){y=t[w];for(x=y.attributes["cke-list-level"];x>r.length;){var g=d.createList(y),o=s.children;0<o.length?o[o.length-1].add(g):(o=new CKEDITOR.htmlParser.element("li",{style:"list-style-type:none"}),o.add(g),s.add(o));r.push(g);q.push(g);s=g;x==r.length&&d.setListSymbol(g,y.attributes["cke-symbol"],x)}for(;x<r.length;){r.pop(),s=r[r.length-1],x==r.length&&d.setListSymbol(s,y.attributes["cke-symbol"],x)}y.remove();s.add(y)}r[0].children.length&&(w=r[0].children[0].attributes["cke-symbol"],!w&&1<r[0].children.length&&(w=r[0].children[1].attributes["cke-symbol"]),w&&d.setListSymbol(r[0],w));for(w=0;w<q.length;w++){d.setListStart(q[w])}for(w=0;w<t.length;w++){this.determineListItemValue(t[w])}}return u},cleanup:function(k){var g=["cke-list-level","cke-symbol","cke-list-id","cke-indentation","cke-dissolved"],n,m;for(n=0;n<k.length;n++){for(m=0;m<g.length;m++){delete k[n].attributes[g[m]]}}},determineListItemValue:function(k){if("ol"===k.parent.name){var g=this.calculateValue(k),n=k.attributes["cke-symbol"].match(/[a-z0-9]+/gi),m;n&&(n=n[n.length-1],m=k.parent.attributes["cke-list-style-type"]||this.numbering.getStyle(n),n=this.numbering.toNumber(n,m),n!==g&&(k.attributes.value=n))}},calculateValue:function(k){if(!k.parent){return 1}var g=k.parent;k=k.getIndex();var p=null,o,m,n;for(n=k;0<=n&&null===p;n--){m=g.children[n],m.attributes&&void 0!==m.attributes.value&&(o=n,p=parseInt(m.attributes.value,10))}null===p&&(p=void 0!==g.attributes.start?parseInt(g.attributes.start,10):1,o=0);return p+(k-o)},dissolveList:function(w){function v(g){return 50<=g?"l"+v(g-50):40<=g?"xl"+v(g-40):10<=g?"x"+v(g-10):9==g?"ix":5<=g?"v"+v(g-5):4==g?"iv":1<=g?"i"+v(g-1):""}function u(m,g){function r(x,y){return x&&x.parent?m(x.parent)?r(x.parent,y+1):r(x.parent,y):y}return r(g,0)}var t=function(g){return function(m){return m.name==g}},q=function(g){return t("ul")(g)||t("ol")(g)},s=CKEDITOR.tools.array,p=[],o,k;w.forEach(function(g){p.push(g)},CKEDITOR.NODE_ELEMENT,!1);o=s.filter(p,t("li"));var n=s.filter(p,q);s.forEach(n,function(x){var z=x.attributes.type,y=parseInt(x.attributes.start,10)||1,r=u(q,x)+1;z||(z=b.parseCssText(x.attributes.style)["list-style-type"]);s.forEach(s.filter(x.children,t("li")),function(A,m){var g;switch(z){case"disc":g="·";break;case"circle":g="o";break;case"square":g="§";break;case"1":case"decimal":g=y+m+".";break;case"a":case"lower-alpha":g=String.fromCharCode(97+y-1+m)+".";break;case"A":case"upper-alpha":g=String.fromCharCode(65+y-1+m)+".";break;case"i":case"lower-roman":g=v(y+m)+".";break;case"I":case"upper-roman":g=v(y+m).toUpperCase()+".";break;default:g="ul"==x.name?"·":y+m+"."}A.attributes["cke-symbol"]=g;A.attributes["cke-list-level"]=r})});o=s.reduce(o,function(m,g){var x=g.children[0];if(x&&x.name&&x.attributes.style&&x.attributes.style.match(/mso-list:/i)){c.pushStylesLower(g,{"list-style-type":!0,display:!0});var r=b.parseCssText(x.attributes.style,!0);c.setStyle(g,"mso-list",r["mso-list"],!0);c.setStyle(x,"mso-list","");delete g["cke-list-level"];(x=r.display?"display":r.DISPLAY?"DISPLAY":"")&&c.setStyle(g,"display",r[x],!0)}if(1===g.children.length&&q(g.children[0])){return m}g.name="p";g.attributes["cke-dissolved"]=!0;m.push(g);return m},[]);for(k=o.length-1;0<=k;k--){o[k].insertAfter(w)}for(k=n.length-1;0<=k;k--){delete n[k].name}},groupLists:function(k){var g,p,o=[[k[0]]],m=o[0];p=k[0];p.attributes["cke-indentation"]=p.attributes["cke-indentation"]||d.getElementIndentation(p);for(g=1;g<k.length;g++){p=k[g];var n=k[g-1];p.attributes["cke-indentation"]=p.attributes["cke-indentation"]||d.getElementIndentation(p);p.previous!==n&&(d.chopDiscontinuousLists(m,o),o.push(m=[]));m.push(p)}d.chopDiscontinuousLists(m,o);return o},chopDiscontinuousLists:function(v,u){for(var t={},s=[[]],q,r=0;r<v.length;r++){var p=t[v[r].attributes["cke-list-level"]],n=this.getListItemInfo(v[r]),o,g;p?(g=p.type.match(/alpha/)&&7==p.index?"alpha":g,g="o"==v[r].attributes["cke-symbol"]&&14==p.index?"alpha":g,o=d.getSymbolInfo(v[r].attributes["cke-symbol"],g),n=this.getListItemInfo(v[r]),(p.type!=o.type||q&&n.id!=q.id&&!this.isAListContinuation(v[r]))&&s.push([])):o=d.getSymbolInfo(v[r].attributes["cke-symbol"]);for(q=parseInt(v[r].attributes["cke-list-level"],10)+1;20>q;q++){t[q]&&delete t[q]}t[v[r].attributes["cke-list-level"]]=o;s[s.length-1].push(v[r]);q=n}[].splice.apply(u,[].concat([b.indexOf(u,v),1],s))},isAListContinuation:function(k){var g=k;do{if((g=g.previous)&&g.type===CKEDITOR.NODE_ELEMENT){if(void 0===g.attributes["cke-list-level"]){break}if(g.attributes["cke-list-level"]===k.attributes["cke-list-level"]){return g.attributes["cke-list-id"]===k.attributes["cke-list-id"]}}}while(g);return !1},getElementIndentation:function(k){k=b.parseCssText(k.attributes.style);if(k.margin||k.MARGIN){k.margin=k.margin||k.MARGIN;var g={styles:{margin:k.margin}};CKEDITOR.filter.transformationsTools.splitMarginShorthand(g);k["margin-left"]=g.styles["margin-left"]}return parseInt(b.convertToPx(k["margin-left"]||"0px"),10)},toArabic:function(g){return g.match(/[ivxl]/i)?g.match(/^l/i)?50+d.toArabic(g.slice(1)):g.match(/^lx/i)?40+d.toArabic(g.slice(1)):g.match(/^x/i)?10+d.toArabic(g.slice(1)):g.match(/^ix/i)?9+d.toArabic(g.slice(2)):g.match(/^v/i)?5+d.toArabic(g.slice(1)):g.match(/^iv/i)?4+d.toArabic(g.slice(2)):g.match(/^i/i)?1+d.toArabic(g.slice(1)):d.toArabic(g.slice(1)):0},getSymbolInfo:function(k,g){var n=k.toUpperCase()==k?"upper-":"lower-",m={"·":["disc",-1],o:["circle",-2],"§":["square",-3]};if(k in m||g&&g.match(/(disc|circle|square)/)){return{index:m[k][1],type:m[k][0]}}if(k.match(/\d/)){return{index:k?parseInt(d.getSubsectionSymbol(k),10):0,type:"decimal"}}k=k.replace(/\W/g,"").toLowerCase();return !g&&k.match(/[ivxl]+/i)||g&&"alpha"!=g||"roman"==g?{index:d.toArabic(k),type:n+"roman"}:k.match(/[a-z]/i)?{index:k.charCodeAt(0)-97,type:n+"alpha"}:{index:-1,type:"disc"}},getListItemInfo:function(k){if(void 0!==k.attributes["cke-list-id"]){return{id:k.attributes["cke-list-id"],level:k.attributes["cke-list-level"]}}var g=b.parseCssText(k.attributes.style)["mso-list"],m={id:"0",level:"1"};g&&(g+=" ",m.level=g.match(/level(.+?)\s+/)[1],m.id=g.match(/l(\d+?)\s+/)[1]);k.attributes["cke-list-level"]=void 0!==k.attributes["cke-list-level"]?k.attributes["cke-list-level"]:m.level;k.attributes["cke-list-id"]=m.id;return m}};d=CKEDITOR.plugins.pastefromword.lists;CKEDITOR.plugins.pastefromword.heuristics={isEdgeListItem:function(k,g){if(!CKEDITOR.env.edge||!k.config.pasteFromWord_heuristicsEdgeList){return !1}var m="";g.forEach&&g.forEach(function(n){m+=n.value},CKEDITOR.NODE_TEXT);return m.match(/^(?: |&nbsp;)*\(?[a-zA-Z0-9]+?[\.\)](?: |&nbsp;){2,}/)?!0:l.isDegenerateListItem(k,g)},cleanupEdgeListItem:function(k){var g=!1;k.forEach(function(m){g||(m.value=m.value.replace(/^(?:&nbsp;|[\s])+/,""),m.value.length&&(g=!0))},CKEDITOR.NODE_TEXT)},isDegenerateListItem:function(k,g){return !!g.attributes["cke-list-level"]||g.attributes.style&&!g.attributes.style.match(/mso\-list/)&&!!g.find(function(m){if(m.type==CKEDITOR.NODE_ELEMENT&&g.name.match(/h\d/i)&&m.getHtml().match(/^[a-zA-Z0-9]+?[\.\)]$/)){return !0}var o=b.parseCssText(m.attributes&&m.attributes.style,!0);if(!o){return !1}var n=o["font-family"]||"";return(o.font||o["font-size"]||"").match(/7pt/i)&&!!m.previous||n.match(/symbol/i)},!0).length},assignListLevels:function(u,t){if(!t.attributes||void 0===t.attributes["cke-list-level"]){for(var s=[d.getElementIndentation(t)],r=[t],p=[],q=CKEDITOR.tools.array,o=q.map;t.next&&t.next.attributes&&!t.next.attributes["cke-list-level"]&&l.isDegenerateListItem(u,t.next);){t=t.next,s.push(d.getElementIndentation(t)),r.push(t)}var m=o(s,function(n,k){return 0===k?0:n-s[k-1]}),g=this.guessIndentationStep(q.filter(s,function(k){return 0!==k})),p=o(s,function(k){return Math.round(k/g)});-1!==q.indexOf(p,0)&&(p=o(p,function(k){return k+1}));q.forEach(r,function(n,k){n.attributes["cke-list-level"]=p[k]});return{indents:s,levels:p,diffs:m}}},guessIndentationStep:function(g){return g.length?Math.min.apply(null,g):null},correctLevelShift:function(k){if(this.isShifted(k)){var g=CKEDITOR.tools.array.filter(k.children,function(n){return"ul"==n.name||"ol"==n.name}),m=CKEDITOR.tools.array.reduce(g,function(o,n){return(n.children&&1==n.children.length&&l.isShifted(n.children[0])?[n]:n.children).concat(o)},[]);CKEDITOR.tools.array.forEach(g,function(n){n.remove()});CKEDITOR.tools.array.forEach(m,function(n){k.add(n,0)});delete k.name}},isShifted:function(g){return"li"!==g.name?!1:0===CKEDITOR.tools.array.filter(g.children,function(k){return k.name&&("ul"==k.name||"ol"==k.name||"p"==k.name&&0===k.children.length)?!1:!0}).length}};l=CKEDITOR.plugins.pastefromword.heuristics;d.setListSymbol.removeRedundancies=function(k,g){(1===g&&"disc"===k["list-style-type"]||"decimal"===k["list-style-type"])&&delete k["list-style-type"]};CKEDITOR.plugins.pastefromword.createAttributeStack=f;CKEDITOR.config.pasteFromWord_heuristicsEdgeList=!0})();