CKEDITOR.dialog.add("select",function(t){function o(g,f,h,k,l){g=s(g);k=k?k.createElement("OPTION"):document.createElement("OPTION");if(g&&k&&"option"==k.getName()){CKEDITOR.env.ie?(isNaN(parseInt(l,10))?g.$.options.add(k.$):g.$.options.add(k.$,l),k.$.innerHTML=0<f.length?f:"",k.$.value=h):(null!==l&&l<g.getChildCount()?g.getChild(0>l?0:l).insertBeforeMe(k):g.append(k),k.setText(0<f.length?f:""),k.setValue(h))}else{return !1}return k}function b(f){f=s(f);for(var c=r(f),g=f.getChildren().count()-1;0<=g;g--){f.getChild(g).$.selected&&f.getChild(g).remove()}j(f,c)}function a(f,c,g,h){f=s(f);if(0>c){return !1}f=f.getChild(c);f.setText(g);f.setValue(h);return f}function e(c){for(c=s(c);c.getChild(0)&&c.getChild(0).remove();){}}function i(g,f,k){g=s(g);var l=r(g);if(0>l){return !1}f=l+f;f=0>f?0:f;f=f>=g.getChildCount()?g.getChildCount()-1:f;if(l==f){return !1}var l=g.getChild(l),m=l.getText(),h=l.getValue();l.remove();l=o(g,m,h,k?k:null,f);j(g,f);return l}function r(c){return(c=s(c))?c.$.selectedIndex:-1}function j(f,c){f=s(f);if(0>c){return null}var g=f.getChildren().count();f.$.selectedIndex=c>=g?g-1:c;return f}function d(c){return(c=s(c))?c.getChildren():!1}function s(c){return c&&c.domId&&c.getInputElement().$?c.getInputElement():c&&c.$?c:!1}return{title:t.lang.forms.select.title,minWidth:CKEDITOR.env.ie?460:395,minHeight:CKEDITOR.env.ie?320:300,onShow:function(){delete this.selectBox;this.setupContent("clear");var f=this.getParentEditor().getSelection().getSelectedElement();if(f&&"select"==f.getName()){this.selectBox=f;this.setupContent(f.getName(),f);for(var f=d(f),c=0;c<f.count();c++){this.setupContent("option",f.getItem(c))}}},onOk:function(){var g=this.getParentEditor(),f=this.selectBox,h=!f;h&&(f=g.document.createElement("select"));this.commitContent(f);if(h&&(g.insertElement(f),CKEDITOR.env.ie)){var k=g.getSelection(),l=k.createBookmarks();setTimeout(function(){k.selectBookmarks(l)},0)}},contents:[{id:"info",label:t.lang.forms.select.selectInfo,title:t.lang.forms.select.selectInfo,accessKey:"",elements:[{id:"txtName",type:"text",widths:["25%","75%"],labelLayout:"horizontal",label:t.lang.common.name,"default":"",accessKey:"N",style:"width:350px",setup:function(f,c){"clear"==f?this.setValue(this["default"]||""):"select"==f&&this.setValue(c.data("cke-saved-name")||c.getAttribute("name")||"")},commit:function(c){this.getValue()?c.data("cke-saved-name",this.getValue()):(c.data("cke-saved-name",!1),c.removeAttribute("name"))}},{id:"txtValue",type:"text",widths:["25%","75%"],labelLayout:"horizontal",label:t.lang.forms.select.value,style:"width:350px","default":"",className:"cke_disabled",onLoad:function(){this.getInputElement().setAttribute("readOnly",!0)},setup:function(f,c){"clear"==f?this.setValue(""):"option"==f&&c.getAttribute("selected")&&this.setValue(c.$.value)}},{type:"hbox",className:"cke_dialog_forms_select_order_txtsize",widths:["175px","170px"],children:[{id:"txtSize",type:"text",labelLayout:"horizontal",label:t.lang.forms.select.size,"default":"",accessKey:"S",style:"width:175px",validate:function(){var c=CKEDITOR.dialog.validate.integer(t.lang.common.validateNumberFailed);return""===this.getValue()||c.apply(this)},setup:function(f,c){"select"==f&&this.setValue(c.getAttribute("size")||"");CKEDITOR.env.webkit&&this.getInputElement().setStyle("width","86px")},commit:function(c){this.getValue()?c.setAttribute("size",this.getValue()):c.removeAttribute("size")}},{type:"html",html:"\x3cspan\x3e"+CKEDITOR.tools.htmlEncode(t.lang.forms.select.lines)+"\x3c/span\x3e"}]},{type:"html",html:"\x3cspan\x3e"+CKEDITOR.tools.htmlEncode(t.lang.forms.select.opAvail)+"\x3c/span\x3e"},{type:"hbox",widths:["115px","115px","100px"],className:"cke_dialog_forms_select_order",children:[{type:"vbox",children:[{id:"txtOptName",type:"text",label:t.lang.forms.select.opText,style:"width:115px",setup:function(c){"clear"==c&&this.setValue("")}},{type:"select",id:"cmbName",label:"",title:"",size:5,style:"width:115px;height:75px",items:[],onChange:function(){var f=this.getDialog(),c=f.getContentElement("info","cmbValue"),g=f.getContentElement("info","txtOptName"),f=f.getContentElement("info","txtOptValue"),h=r(this);j(c,h);g.setValue(this.getValue());f.setValue(c.getValue())},setup:function(f,c){"clear"==f?e(this):"option"==f&&o(this,c.getText(),c.getText(),this.getDialog().getParentEditor().document)},commit:function(k){var h=this.getDialog(),n=d(this),p=d(h.getContentElement("info","cmbValue")),q=h.getContentElement("info","txtValue").getValue();e(k);for(var m=0;m<n.count();m++){var l=o(k,n.getItem(m).getValue(),p.getItem(m).getValue(),h.getParentEditor().document);p.getItem(m).getValue()==q&&(l.setAttribute("selected","selected"),l.selected=!0)}}}]},{type:"vbox",children:[{id:"txtOptValue",type:"text",label:t.lang.forms.select.opValue,style:"width:115px",setup:function(c){"clear"==c&&this.setValue("")}},{type:"select",id:"cmbValue",label:"",size:5,style:"width:115px;height:75px",items:[],onChange:function(){var f=this.getDialog(),c=f.getContentElement("info","cmbName"),g=f.getContentElement("info","txtOptName"),f=f.getContentElement("info","txtOptValue"),h=r(this);j(c,h);g.setValue(c.getValue());f.setValue(this.getValue())},setup:function(f,c){if("clear"==f){e(this)}else{if("option"==f){var g=c.getValue();o(this,g,g,this.getDialog().getParentEditor().document);"selected"==c.getAttribute("selected")&&this.getDialog().getContentElement("info","txtValue").setValue(g)}}}}]},{type:"vbox",padding:5,children:[{type:"button",id:"btnAdd",label:t.lang.forms.select.btnAdd,title:t.lang.forms.select.btnAdd,style:"width:100%;",onClick:function(){var g=this.getDialog(),f=g.getContentElement("info","txtOptName"),h=g.getContentElement("info","txtOptValue"),k=g.getContentElement("info","cmbName"),l=g.getContentElement("info","cmbValue");o(k,f.getValue(),f.getValue(),g.getParentEditor().document);o(l,h.getValue(),h.getValue(),g.getParentEditor().document);f.setValue("");h.setValue("")}},{type:"button",id:"btnModify",label:t.lang.forms.select.btnModify,title:t.lang.forms.select.btnModify,style:"width:100%;",onClick:function(){var g=this.getDialog(),f=g.getContentElement("info","txtOptName"),h=g.getContentElement("info","txtOptValue"),k=g.getContentElement("info","cmbName"),g=g.getContentElement("info","cmbValue"),l=r(k);0<=l&&(a(k,l,f.getValue(),f.getValue()),a(g,l,h.getValue(),h.getValue()))}},{type:"button",id:"btnUp",style:"width:100%;",label:t.lang.forms.select.btnUp,title:t.lang.forms.select.btnUp,onClick:function(){var g=this.getDialog(),f=g.getContentElement("info","cmbName"),h=g.getContentElement("info","cmbValue");i(f,-1,g.getParentEditor().document);i(h,-1,g.getParentEditor().document)}},{type:"button",id:"btnDown",style:"width:100%;",label:t.lang.forms.select.btnDown,title:t.lang.forms.select.btnDown,onClick:function(){var g=this.getDialog(),f=g.getContentElement("info","cmbName"),h=g.getContentElement("info","cmbValue");i(f,1,g.getParentEditor().document);i(h,1,g.getParentEditor().document)}}]}]},{type:"hbox",widths:["40%","20%","40%"],children:[{type:"button",id:"btnSetValue",label:t.lang.forms.select.btnSetValue,title:t.lang.forms.select.btnSetValue,onClick:function(){var f=this.getDialog(),c=f.getContentElement("info","cmbValue");f.getContentElement("info","txtValue").setValue(c.getValue())}},{type:"button",id:"btnDelete",label:t.lang.forms.select.btnDelete,title:t.lang.forms.select.btnDelete,onClick:function(){var g=this.getDialog(),f=g.getContentElement("info","cmbName"),k=g.getContentElement("info","cmbValue"),h=g.getContentElement("info","txtOptName"),g=g.getContentElement("info","txtOptValue");b(f);b(k);h.setValue("");g.setValue("")}},{type:"vbox",children:[{id:"chkMulti",type:"checkbox",label:t.lang.forms.select.chkMulti,"default":"",accessKey:"M",value:"checked",setup:function(f,c){"select"==f&&this.setValue(c.getAttribute("multiple"))},commit:function(c){this.getValue()?c.setAttribute("multiple",this.getValue()):c.removeAttribute("multiple")}},{id:"required",type:"checkbox",label:t.lang.forms.select.required,"default":"",accessKey:"Q",value:"checked",setup:function(f,c){"select"==f&&this.setValue(c.getAttribute("required"))},commit:function(c){this.getValue()?c.setAttribute("required","required"):c.removeAttribute("required")}}]}]}]}]}});